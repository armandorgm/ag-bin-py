first working version with errors